{"version":3,"sources":["game-admin.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"game-admin.js","sourcesContent":["var new_hint_visible = false;\nvar map;\nvar next_clue;\n\nfunction initMap() {\n\t$('.pac-container').remove();\n\n\t// Specify features and elements to define styles.\n\t\n\t// Create a map object and specify the DOM element for display.\n\tmap = new google.maps.Map(document.getElementById('map'), {\n    \tcenter:new google.maps.LatLng(24.9095, 91.8611),\n\t\tscrollwheel: true,\n\t\t// Apply the map style array to the map.\n\t\tzoom: 12\n\t});\n\n\tgoogle.maps.event.trigger(map, 'resize');\n\n\t// Create the search box and link it to the UI element.\n\tvar i = document.createElement('input');\n\t$(i)\n\t\t.addClass('controls')\n\t\t.attr('type', 'text')\n\t\t.attr('id', 'pac-input')\n\t\t.attr('placeholder', 'Search...');\n\n\tvar searchBox = new google.maps.places.SearchBox(i);\n\tmap.controls[google.maps.ControlPosition.TOP_LEFT].push(i);\n\n\n\tvar searchMarkers = [];\n\t// Listen for the event fired when the user selects a prediction and retrieve\n\t// more details for that place.\n\tsearchBox.addListener('places_changed', function() {\n\t\tvar places = searchBox.getPlaces();\n\n\t\tif (places.length == 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Clear out the old searchMarkers.\n\t\tsearchMarkers.forEach(function(marker) {\n\t\t\tmarker.setMap(null);\n\t\t});\n\t\tsearchMarkers = [];\n\t\tnew_hint_visible = false;\n\n\t\t// For each place, get the icon, name and location.\n\t\tvar bounds = new google.maps.LatLngBounds();\n\t\tplaces.forEach(function(place) {\n\t\t\tvar icon = {\n\t\t\t\turl: place.icon,\n\t\t\t\tsize: new google.maps.Size(71, 71),\n\t\t\t\torigin: new google.maps.Point(0, 0),\n\t\t\t\tanchor: new google.maps.Point(17, 34),\n\t\t\t\tscaledSize: new google.maps.Size(25, 25)\n\t\t\t};\n\n\t\t\t// Create a marker for each place.\n\t\t\tsearchMarkers.push(new google.maps.Marker({\n\t\t\t\tmap: map,\n\t\t\t\ticon: icon,\n\t\t\t\ttitle: place.name,\n\t\t\t\tposition: place.geometry.location\n\t\t\t}));\n\n\t\t\tif (place.geometry.viewport) {\n\t\t\t\t// Only geocodes have viewport.\n\t\t\t\tbounds.union(place.geometry.viewport);\n\t\t\t} else {\n\t\t\t\tbounds.extend(place.geometry.location);\n\t\t\t}\n\t\t});\n\t\tmap.fitBounds(bounds);\n\t});\n\n\tgoogle.maps.event.addListener(map, 'click', function(event) {\n\t   placeMarker(event.latLng);\n\t});\n}\n\nfunction placeMarker(location, old_data) {\n\tconsole.log(old_data)\n    var marker = new google.maps.Marker({\n        position: location,\n    \tanimation: google.maps.Animation.DROP,\n    \tdraggable:true,\n        map: map\n    });\n\n    if(typeof old_data == 'undefined'){\n    \told_data = {\n    \t\tid: '',\n    \t\tclue: '',\n    \t\twelcome_text: '',\n    \t\tquestions: '',\n    \t\tmin_zoom: map.getZoom()\n    \t}\n    }\n\n    \n\n    var group = $('<div class=\"group\"/>');\n    $('<h6/>').text(marker.getPosition().toString()).appendTo(group);\n    var content = $('<div/>').appendTo(group);\n    $('<br/>').appendTo(content);\n    group.appendTo('#clues');\n\n    $('<input type=\"hidden\" class=\"lat\"/>').appendTo(content).val(marker.getPosition().lat());\n    $('<input type=\"hidden\" class=\"lng\"/>').appendTo(content).val(marker.getPosition().lng);\n    $('<input type=\"hidden\" class=\"id\"/>').appendTo(content).val(old_data.id);\n    \n    $('<p/>').appendTo(content).text(\"Zoom :\").append( $('<input type=\"text\" class=\"zoom\"/>').val(old_data.min_zoom).addClass('form-control')\t);\n\n    $('<p/>').text('Clue')\n    \t.append($('<textarea/>').addClass('form-control clue').val(old_data.clue))\n    \t.appendTo(content);\n\n    $('<p/>').text('Welcome Text')\n    \t.append($('<textarea/>').addClass('form-control welcome-text').val(old_data.welcome_text))\n    \t.appendTo(content);\n\n    $('<p/>').text('Question Answers')\n    \t.append($('<textarea/>').addClass('form-control question-answers').val(old_data.questions).attr('placeholder', 'Put in the format \"question|ans1,ans2,ans3...\" one per line'))\n    \t.appendTo(content)\n    \t.val(old_data.questions);\n\n    $('<button/>')\n    \t.addClass('btn btn-default delete')\n    \t.text('Remove')\n    \t.appendTo(content)\n    \t.click(function(){\n    \t\tgroup.remove();\n    \t\tmarker.setMap(null);\n    \t});\n\n    $('#clues').accordion( \"refresh\" );\n    $('#clues').sortable( \"refreshPositions\" );\n\n    marker.config = group;\n\n    google.maps.event.addListener(marker,'mousedown',function(event){\n    \tmarker.config.css('opacity', 0.5);\n    });\n\n    google.maps.event.addListener(marker,'mouseup',function(event){\n    \tmarker.config.css('opacity', 1);\n    });\n\n    google.maps.event.addListener(marker,'dragend',function(event){\n        marker.config.find('h6').text(marker.getPosition().toString());\n        marker.config.find('.lat').val(marker.getPosition().lat());\n        marker.config.find('.lng').val(marker.getPosition().lng());\n    });\n}\n\njQuery(window).on('load', function(){\n\tif( 'undefined' != typeof google ){\n\n\t\tinitMap();\n\n\n\t\tjQuery.each(data.locations, function(k, v){\n\t\t\tplaceMarker({lat:parseFloat(v.lat), parseFloat(lng:v.lng)}, v);\n\t\t});\n\t}\n});\n\njQuery(document).ready(function(){\n\t$('#clues').accordion({\n\t\theader: \"> div > h6\",\n\t\tcollapsible: true\n\t})\n\t.sortable({\n\t\taxis: \"y\",\n\t\thandle: \"h6\",\n\t\tstop: function( event, ui ) {\n\t\t\t// IE doesn't register the blur when sorting\n\t\t\t// so trigger focusout handlers to remove .ui-state-focus\n\t\t\tui.item.children( \"h3\" ).triggerHandler( \"focusout\" );\n\n\t\t\t// Refresh accordion to handle new order\n\t\t\t$( this ).accordion( \"refresh\" );\n\t\t}\n\t});\n\n\tjQuery.each(data.config, function(k, v){\n\t\t$('#'+k).val(v);\n\t});\n});\n\nfunction save_config(){\n\tvar yes = window.confirm(\"Sure you want to save? All previous data excluding user accounts will be lost.\");\n\n\tif( !yes ) return;\n\n\n\tvar conf = {\n\t\tstarting_time: $('#starting_time').val(),\n\t\tduration: $('#duration').val(),\n\t\tfreez_time: $('#freez_time').val()\n\t}\n\n\tvar locations = [];\n\t$('#clues .group').each(function(){\n\t\tvar loc = {\n\t\t\tlat: $(this).find('.lat').val(),\n\t\t\tlng: $(this).find('.lng').val(),\n\t\t\tzoom: $(this).find('.zoom').val(),\n\t\t\tclue: $(this).find('.clue').val(),\n\t\t\twelcome_text: $(this).find('.welcome-text').val(),\n\t\t\tquestions: $(this).find('.question-answers').val(),\n\t\t}\n\n\t\tlocations.push(loc)\n\t})\n\n\t$('.saving').fadeIn();\n\n\t$.post(urls.config, { config: conf, locations: locations }, function(){\n\t\t$('.saving').hide();\n\t\t$('.saved').show();\n\t\tsetTimeout(function(){\n\t\t\t$('.saved').fadeOut();\n\t\t}, 3000);\n\t});\n}\n\nfunction save_all(){\n\tvar yes = window.confirm(\"Sure you want to save? All previous data excluding user accounts will be lost.\");\n\n\tif( !yes ) return;\n\n\n\tvar conf = {\n\t\tstarting_time: $('#starting_time').val(),\n\t\tduration: $('#duration').val(),\n\t\tfreez_time: $('#freez_time').val(),\n\t\tfinal_greeting: $('#final_greeting').val()\n\t}\n\n\tvar locations = [];\n\t$('#clues .group').each(function(){\n\t\tvar loc = {\n\t\t\tlat: $(this).find('.lat').val(),\n\t\t\tlng: $(this).find('.lng').val(),\n\t\t\tzoom: $(this).find('.zoom').val(),\n\t\t\tclue: $(this).find('.clue').val(),\n\t\t\twelcome_text: $(this).find('.welcome-text').val(),\n\t\t\tquestions: $(this).find('.question-answers').val(),\n\t\t}\n\n\t\tlocations.push(loc)\n\t})\n\n\t$('.saving').fadeIn();\n\n\t$.post(urls.config, { config: conf, locations: locations, action: 'save_all' }, function(){\n\t\t$('.saving').hide();\n\t\t$('.saved').show();\n\t\tsetTimeout(function(){\n\t\t\t$('.saved').fadeOut();\n\t\t}, 3000);\n\t});\n}\n\nfunction save_config(){\n\tvar conf = {\n\t\tstarting_time: $('#starting_time').val(),\n\t\tduration: $('#duration').val(),\n\t\tfreez_time: $('#freez_time').val(),\n\t\tfinal_greeting: $('#final_greeting').val()\n\t}\n\n\t$('.saving').fadeIn();\n\n\t$.post(urls.config, { config: conf, action: 'save_config' }, function(){\n\t\t$('.saving').hide();\n\t\t$('.saved').show();\n\t\tsetTimeout(function(){\n\t\t\t$('.saved').fadeOut();\n\t\t}, 3000);\n\t});\n}\n\n\n\n"],"sourceRoot":"/source/"}